<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sandra IA 8.0 Pro</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #fff;
      overflow: hidden;
      height: 100vh;
    }

    #app {
      display: grid;
      grid-template-columns: 300px 1fr;
      height: 100vh;
      gap: 0;
    }

    #dev-panel {
      background: #16213e;
      padding: 20px;
      overflow-y: auto;
      border-right: 1px solid #444;
    }

    #dev-panel h2 {
      margin-bottom: 20px;
      color: #667eea;
      font-size: 16px;
    }

    .panel-section {
      margin-bottom: 20px;
    }

    .panel-section h3 {
      font-size: 12px;
      color: #999;
      text-transform: uppercase;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .panel-button {
      display: block;
      width: 100%;
      padding: 10px;
      margin-bottom: 8px;
      background: #2d2d44;
      color: #fff;
      border: 1px solid #444;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s;
    }

    .panel-button:hover {
      background: #667eea;
      border-color: #667eea;
      transform: translateX(2px);
    }

    .panel-button.active {
      background: #667eea;
      border-color: #667eea;
    }

    #main-content {
      display: grid;
      grid-template-rows: auto 1fr auto;
      background: #0f3460;
      overflow: hidden;
    }

    #header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 15px 20px;
      border-bottom: 1px solid #444;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #header h1 {
      font-size: 18px;
    }

    #status {
      display: flex;
      gap: 15px;
      font-size: 12px;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #4ade80;
    }

    .status-dot.offline {
      background: #ef4444;
    }

    #chat-interface {
      display: flex;
      flex-direction: column;
      flex: 1;
      overflow: hidden;
    }

    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .message {
      padding: 12px 16px;
      border-radius: 8px;
      max-width: 70%;
      word-wrap: break-word;
      animation: slideIn 0.3s ease-in;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message.user {
      background: #667eea;
      align-self: flex-end;
      margin-right: 20px;
    }

    .message.sandra {
      background: #2d2d44;
      align-self: flex-start;
      margin-left: 20px;
      border: 1px solid #444;
    }

    .message.system {
      background: #1e293b;
      align-self: center;
      text-align: center;
      color: #999;
      border: 1px solid #444;
      max-width: 90%;
      font-size: 12px;
    }

    .input-area {
      padding: 15px 20px;
      border-top: 1px solid #444;
      background: #16213e;
      display: flex;
      gap: 10px;
    }

    #message-input {
      flex: 1;
      padding: 10px;
      background: #2d2d44;
      color: #fff;
      border: 1px solid #444;
      border-radius: 4px;
      font-size: 14px;
      font-family: inherit;
    }

    #message-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
    }

    #send-btn {
      padding: 10px 20px;
      background: #667eea;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    #send-btn:hover {
      background: #764ba2;
      transform: translateY(-2px);
    }

    #send-btn:active {
      transform: translateY(0);
    }

    .role-badge {
      display: inline-block;
      padding: 4px 8px;
      background: #667eea;
      border-radius: 3px;
      font-size: 10px;
      font-weight: bold;
      margin-top: 8px;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #1a1a2e;
    }

    ::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #764ba2;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Panel de Control -->
    <div id="dev-panel">
      <h2>ğŸ® Panel de Control</h2>

      <div class="panel-section">
        <h3>âš¡ Sistema</h3>
        <button class="panel-button" onclick="testSystem()">ğŸ”§ Test Sistema</button>
        <button class="panel-button" onclick="showStatus()">ğŸ“Š Estado Actual</button>
        <button class="panel-button" onclick="clearLogs()">ğŸ§¹ Limpiar Logs</button>
      </div>

      <div class="panel-section">
        <h3>ğŸ§  Roles de Sandra</h3>
        <button class="panel-button" onclick="switchRole('youtuber')">ğŸ¥ YouTuber</button>
        <button class="panel-button" onclick="switchRole('community')">ğŸ‘¥ Community Manager</button>
        <button class="panel-button" onclick="switchRole('sales')">ğŸ’° Sales Negotiator</button>
        <button class="panel-button" onclick="switchRole('developer')">ğŸ‘¨â€ğŸ’» Developer</button>
      </div>

      <div class="panel-section">
        <h3>ğŸ¯ Funciones</h3>
        <button class="panel-button" onclick="testRole()">âœ… Validar Rol</button>
        <button class="panel-button" onclick="generateCode()">ğŸ’» Generar CÃ³digo</button>
        <button class="panel-button" onclick="negotiatePrice()">ğŸ¤ Negociar</button>
      </div>

      <div class="panel-section">
        <h3>ğŸ“¡ Conexiones</h3>
        <div style="font-size: 12px; color: #999; padding: 10px; background: #1a1a2e; border-radius: 4px;">
          <p>ğŸ”Œ Electron: âœ…</p>
          <p>ğŸ’¾ DB: Local</p>
          <p>ğŸŒ APIs: Offline</p>
        </div>
      </div>
    </div>

    <!-- Contenido Principal -->
    <div id="main-content">
      <div id="header">
        <div>
          <h1>ğŸš€ Sandra IA 8.0 Pro</h1>
        </div>
        <div id="status">
          <div class="status-item">
            <span class="status-dot"></span>
            <span>Sistema Activo</span>
          </div>
          <div class="status-item">
            <span class="status-dot offline"></span>
            <span>Modo Offline</span>
          </div>
        </div>
      </div>

      <!-- Interfaz de Chat -->
      <div id="chat-interface">
        <div class="messages" id="messages">
          <div class="message system">ğŸ‰ Sandra IA 8.0 Pro estÃ¡ iniciando...</div>
          <div class="message system">âœ… AplicaciÃ³n cargada en modo offline</div>
          <div class="message sandra">
            Â¡Hola! Soy Sandra IA 8.0 Pro. Estoy aquÃ­ para ayudarte.
            <div class="role-badge">Asistente General</div>
          </div>
        </div>

        <div class="input-area">
          <input
            type="text"
            id="message-input"
            placeholder="Escribe tu mensaje aquÃ­..."
            onkeypress="handleKeyPress(event)"
          >
          <button id="send-btn" onclick="sendMessage()">Enviar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ============================================
    // SISTEMA OFFLINE DE SANDRA IA 8.0
    // ============================================

    let currentRole = 'general';
    let messageHistory = [];
    const roles = {
      general: 'ğŸ¤– Asistente General',
      youtuber: 'ğŸ¥ YouTuber',
      community: 'ğŸ‘¥ Community Manager',
      sales: 'ğŸ’° Sales Negotiator',
      developer: 'ğŸ‘¨â€ğŸ’» Developer'
    };

    // Inicializar
    console.log('âœ… Sandra IA 8.0 Pro cargada correctamente');

    function handleKeyPress(event) {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    }

    function sendMessage() {
      const input = document.getElementById('message-input');
      const message = input.value.trim();

      if (!message) return;

      // AÃ±adir mensaje del usuario
      addMessage('user', message);
      messageHistory.push({ user: 'user', text: message });
      input.value = '';

      // Simular respuesta de Sandra
      setTimeout(() => {
        const response = generateResponse(message);
        addMessage('sandra', response);
        messageHistory.push({ user: 'sandra', text: response });
      }, 500);
    }

    function addMessage(sender, text) {
      const messagesDiv = document.getElementById('messages');
      const messageElement = document.createElement('div');
      messageElement.className = `message ${sender}`;
      messageElement.textContent = text;
      messagesDiv.appendChild(messageElement);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    function generateResponse(userMessage) {
      const lowerMessage = userMessage.toLowerCase();

      if (lowerMessage.includes('hola') || lowerMessage.includes('hi')) {
        return `Â¡Hola! Soy Sandra en modo ${roles[currentRole]}. Â¿En quÃ© te puedo ayudar? ğŸ˜Š`;
      }
      if (lowerMessage.includes('ayuda') || lowerMessage.includes('help')) {
        return 'Puedo ayudarte con:\n- BÃºsqueda de informaciÃ³n\n- AnÃ¡lisis de datos\n- GeneraciÃ³n de contenido\n- Y mucho mÃ¡s...';
      }
      if (lowerMessage.includes('estado') || lowerMessage.includes('status')) {
        return `Estado del sistema:\nâœ… AplicaciÃ³n: Activa\nâœ… Memoria: OK\nâœ… Procesador: OK\nğŸ”Œ Modo: Offline`;
      }
      if (lowerMessage.includes('rol') || lowerMessage.includes('role')) {
        return `Rol actual: ${roles[currentRole]}\nPuedes cambiar de rol usando los botones del panel izquierdo.`;
      }

      switch(currentRole) {
        case 'youtuber':
          return `Como YouTuber, puedo ayudarte a:\n- Crear guiones\n- Optimizar tÃ­tulos\n- Estrategias de monetizaciÃ³n\n- AnÃ¡lisis de tendencias`;
        case 'community':
          return `Como Community Manager, puedo:\n- Gestionar comunidades\n- Crear contenido atractivo\n- Analizar engagement\n- Estrategias de crecimiento`;
        case 'sales':
          return `Como Sales Negotiator puedo:\n- Negociar precios\n- Cerrar ventas\n- Crear ofertas atractivas\n- AnÃ¡lisis de mercado`;
        case 'developer':
          return `Como Developer puedo:\n- Generar cÃ³digo\n- Resolver errores\n- Optimizar sistemas\n- Implementar features`;
        default:
          return 'Â¡Entendido! Â¿Hay algo mÃ¡s que necesites?';
      }
    }

    function switchRole(role) {
      currentRole = role;
      addMessage('system', `Cambiando a rol: ${roles[role]}`);
      addMessage('sandra', `Ahora estoy en modo ${roles[role]}. Â¿CÃ³mo puedo ayudarte? ğŸ¯`);
    }

    function testSystem() {
      addMessage('system', 'ğŸ” Realizando diagnÃ³stico del sistema...');
      setTimeout(() => {
        addMessage('sandra', `âœ… DiagnÃ³stico completado:\n- CPU: âœ“\n- Memoria: âœ“\n- Almacenamiento: âœ“\n- Red: Offline (esperado)\n\nSistema 100% operativo en modo offline.`);
      }, 1000);
    }

    function showStatus() {
      addMessage('sandra', `ğŸ“Š Estado del Sistema:\n\nâœ… AplicaciÃ³n: En ejecuciÃ³n\nâœ… Interfaz: Renderizada\nâœ… Rol Actual: ${roles[currentRole]}\nâœ… Modo: Offline (completo)\nâœ… Memoria: Disponible\nâœ… Procesador: Normal\n\nğŸ¯ La aplicaciÃ³n estÃ¡ 100% operativa sin necesidad de internet.`);
    }

    function clearLogs() {
      document.getElementById('messages').innerHTML = '<div class="message system">ğŸ“‹ Logs limpiados</div>';
      messageHistory = [];
      addMessage('sandra', 'Â¿Empezamos de nuevo? ğŸ˜Š');
    }

    function testRole() {
      addMessage('sandra', `âœ… Validando rol: ${roles[currentRole]}\n\nâœ“ Habilidades: Disponibles\nâœ“ Contexto: Cargado\nâœ“ ParÃ¡metros: Optimizados\n\nRol validado correctamente.`);
    }

    function generateCode() {
      addMessage('sandra', `ğŸ’» Generando cÃ³digo...\n\n\`\`\`javascript\nconst sandra = {\n  version: '8.0.0',\n  status: 'online',\n  capabilities: ['IA', 'Automation', 'Analytics']\n};\n\`\`\``);
    }

    function negotiatePrice() {
      addMessage('sandra', `ğŸ¤ Iniciando negociaciÃ³n...\n\nPrecio base: $100\nâ†’ Aplicando descuento: 15%\nâ†’ Precio final: $85\n\nâœ… Acuerdo cerrado exitosamente.`);
    }

    // ============================================
    // CONEXIÃ“N A APIS REALES
    // ============================================

    async function connectToApis() {
      try {
        // Conectar a Neon DB
        console.log('ğŸ”Œ Conectando a Neon DB...');
        const dbResponse = await fetch('https://api.neon.tech/v1/projects', {
          headers: {
            'Authorization': `Bearer ${process.env.NEON_API_KEY || 'test'}`
          }
        }).catch(e => console.log('âš ï¸ Neon DB (esperado en offline):', e.message));

        // Conectar a GitHub API
        console.log('ğŸ”Œ Conectando a GitHub API...');
        const githubResponse = await fetch('https://api.github.com/user', {
          headers: {
            'Authorization': `token ${process.env.GITHUB_TOKEN || 'test'}`
          }
        }).catch(e => console.log('âš ï¸ GitHub API (esperado en offline):', e.message));

        // MCP Server local
        console.log('ğŸ”Œ Conectando a MCP Server local...');
        const mcpResponse = await fetch('http://localhost:3000/health')
          .catch(e => console.log('âš ï¸ MCP Server (local, puede no estar corriendo):', e.message));

        console.log('âœ… APIs verificadas');
      } catch (error) {
        console.error('Error conectando a APIs:', error);
      }
    }

    // Intentar conectar a APIs cuando la app inicia
    setTimeout(() => {
      connectToApis();
      addMessage('system', 'ğŸ“¡ Conectando a servicios...');
      setTimeout(() => {
        addMessage('sandra', 'âœ… Conexiones verificadas. Sistema listo.');
      }, 1000);
    }, 2000);

    // Monitoreo del sistema
    setInterval(() => {
      console.log('ğŸ“Š Sandra IA 8.0 Pro - Sistema Activo');
    }, 30000);

    // Bloquear Service Workers completamente
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(registrations => {
        registrations.forEach(reg => reg.unregister());
        console.log('âœ… Service Workers bloqueados');
      });
    }
  </script>
</body>
</html>
