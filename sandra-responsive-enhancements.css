/**
 * Sandra IA Mobile - Galaxy Level Responsive Enhancements
 *
 * Comprehensive responsive design system for all device types
 * Builds upon existing Sandra IA Mobile theme while adding
 * advanced adaptations for optimal user experience
 */

/* =================================================================== */
/* ENHANCED DEVICE-SPECIFIC VARIABLES */
/* =================================================================== */

:root {
    /* Extended Breakpoint System */
    --breakpoint-xs: 320px;      /* iPhone SE, compact Android */
    --breakpoint-sm: 375px;      /* iPhone 12/13/14 standard */
    --breakpoint-md: 414px;      /* iPhone Pro Max, large Android */
    --breakpoint-lg: 480px;      /* Extra large phones */
    --breakpoint-xl: 568px;      /* Landscape phones */
    --breakpoint-tablet: 768px;  /* iPad standard */
    --breakpoint-tablet-lg: 1024px; /* iPad Pro */
    --breakpoint-desktop: 1200px;

    /* Dynamic Values (Updated by JavaScript) */
    --touch-target-dynamic: var(--touch-target-min);
    --font-scale: 1;
    --spacing-base-dynamic: var(--spacing-md);
    --content-margin-dynamic: var(--spacing-md);

    /* Enhanced Safe Area Support */
    --safe-area-top-extended: max(var(--safe-area-inset-top), 20px);
    --safe-area-bottom-extended: max(var(--safe-area-inset-bottom), 20px);

    /* Device-Specific Touch Targets */
    --touch-target-phone-small: 48px;
    --touch-target-phone-standard: 44px;
    --touch-target-tablet: 52px;
    --touch-target-desktop: 40px;

    /* Adaptive Typography */
    --font-scale-xs: 0.9;
    --font-scale-sm: 1.0;
    --font-scale-md: 1.05;
    --font-scale-lg: 1.1;
    --font-scale-tablet: 1.15;
    --font-scale-desktop: 1.1;

    /* Orientation-Specific Values */
    --header-height-portrait: 60px;
    --header-height-landscape: 44px;
    --sidebar-width-portrait: 280px;
    --sidebar-width-landscape: 320px;

    /* Foldable Device Support */
    --foldable-hinge-margin: 20px;
    --foldable-content-padding: 24px;
}

/* =================================================================== */
/* DEVICE-SPECIFIC BASE STYLES */
/* =================================================================== */

/* Small phones (< 375px) */
body.device-phone-small {
    --touch-target-min: var(--touch-target-phone-small);
    --spacing-md: 12px;
    --spacing-lg: 20px;
    --font-md: calc(var(--font-md) * var(--font-scale-xs));
}

body.device-phone-small .header {
    padding: 12px 16px;
    min-height: 52px;
}

body.device-phone-small .logo {
    font-size: 18px;
}

body.device-phone-small .status-item {
    font-size: 11px;
    padding: 4px 8px;
    min-height: 24px;
}

body.device-phone-small .message {
    max-width: 85%;
    font-size: 14px;
}

body.device-phone-small .input-field {
    font-size: 14px;
    padding: 12px 50px 12px 16px;
}

/* Standard phones (375-414px) */
body.device-phone-standard {
    --touch-target-min: var(--touch-target-phone-standard);
    --font-md: calc(var(--font-md) * var(--font-scale-sm));
}

body.device-phone-standard .message {
    max-width: 80%;
}

/* Large phones (414-480px) */
body.device-phone-large {
    --font-md: calc(var(--font-md) * var(--font-scale-md));
}

body.device-phone-large .message {
    max-width: 75%;
}

body.device-phone-large .status-bar {
    gap: 12px;
}

/* Extra large phones (480px+) */
body.device-phone-xlarge {
    --font-md: calc(var(--font-md) * var(--font-scale-lg));
    --spacing-lg: 28px;
}

body.device-phone-xlarge .header {
    padding: 16px 24px;
}

body.device-phone-xlarge .message {
    max-width: 70%;
}

/* Tablets */
body.device-tablet,
body.device-tablet-large {
    --touch-target-min: var(--touch-target-tablet);
    --font-md: calc(var(--font-md) * var(--font-scale-tablet));
    --spacing-xl: 40px;
}

body.device-tablet .main-container,
body.device-tablet-large .main-container {
    flex-direction: row;
}

body.device-tablet .sidebar,
body.device-tablet-large .sidebar {
    position: static;
    width: var(--sidebar-width-portrait);
    transform: translateX(0);
    border-right: 1px solid var(--border-primary);
}

body.device-tablet .sidebar-toggle,
body.device-tablet-large .sidebar-toggle {
    display: none;
}

body.device-tablet .message,
body.device-tablet-large .message {
    max-width: 65%;
}

/* Foldable devices */
body.device-foldable {
    --content-margin-dynamic: var(--foldable-content-padding);
}

body.device-foldable .main-container {
    padding: 0 var(--foldable-hinge-margin);
}

body.device-foldable .chat-area {
    max-width: calc(100vw - 2 * var(--foldable-hinge-margin));
}

/* =================================================================== */
/* ORIENTATION-SPECIFIC ADAPTATIONS */
/* =================================================================== */

/* Portrait orientation optimizations */
body.orientation-portrait.device-phone-small .header,
body.orientation-portrait.device-phone-standard .header,
body.orientation-portrait.device-phone-large .header,
body.orientation-portrait.device-phone-xlarge .header {
    min-height: var(--header-height-portrait);
}

/* Landscape orientation optimizations */
body.orientation-landscape.device-phone-small,
body.orientation-landscape.device-phone-standard,
body.orientation-landscape.device-phone-large,
body.orientation-landscape.device-phone-xlarge {
    --header-height: var(--header-height-landscape);
}

body.orientation-landscape .header {
    padding: 8px 16px;
    min-height: var(--header-height-landscape);
}

body.orientation-landscape .logo {
    font-size: calc(var(--font-xl) * 0.9);
}

body.orientation-landscape .status-item {
    font-size: 11px;
    padding: 4px 8px;
    min-height: 26px;
}

body.orientation-landscape .messages {
    padding: 12px 16px;
}

body.orientation-landscape .input-area {
    padding: 12px 16px;
    padding-bottom: max(12px, var(--safe-area-inset-bottom));
}

body.orientation-landscape .message {
    margin: 6px 0;
}

/* Landscape tablets - different behavior */
body.orientation-landscape.device-tablet .sidebar,
body.orientation-landscape.device-tablet-large .sidebar {
    width: var(--sidebar-width-landscape);
}

/* =================================================================== */
/* ADVANCED RESPONSIVE GRID SYSTEM */
/* =================================================================== */

.responsive-grid {
    display: grid;
    gap: var(--spacing-md);
    padding: var(--content-margin-dynamic);
}

/* Phone grids */
.device-phone-small .responsive-grid,
.device-phone-standard .responsive-grid {
    grid-template-columns: 1fr;
}

.device-phone-large .responsive-grid,
.device-phone-xlarge .responsive-grid {
    grid-template-columns: 1fr;
}

/* Tablet grids */
.device-tablet .responsive-grid {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
}

.device-tablet-large .responsive-grid {
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
}

/* Foldable grids */
.device-foldable .responsive-grid {
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
}

/* =================================================================== */
/* ENHANCED TOUCH TARGET OPTIMIZATION */
/* =================================================================== */

.touch-target {
    min-height: var(--touch-target-dynamic);
    min-width: var(--touch-target-dynamic);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.touch-target::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    min-height: var(--touch-target-dynamic);
    min-width: var(--touch-target-dynamic);
    z-index: -1;
}

/* Voice and send buttons */
.voice-btn,
.send-btn,
.file-btn {
    min-height: var(--touch-target-dynamic);
    min-width: var(--touch-target-dynamic);
    border-radius: 50%;
}

/* Small screen adjustments */
.device-phone-small .voice-btn,
.device-phone-small .send-btn,
.device-phone-small .file-btn {
    min-height: 48px;
    min-width: 48px;
}

/* =================================================================== */
/* ADAPTIVE TYPOGRAPHY SYSTEM */
/* =================================================================== */

.adaptive-text {
    font-size: calc(var(--font-md) * var(--font-scale));
    line-height: 1.5;
}

.adaptive-text-sm {
    font-size: calc(var(--font-sm) * var(--font-scale));
    line-height: 1.4;
}

.adaptive-text-lg {
    font-size: calc(var(--font-lg) * var(--font-scale));
    line-height: 1.6;
}

/* Responsive font scaling */
@media (max-width: 374px) {
    :root {
        --font-scale: var(--font-scale-xs);
    }
}

@media (min-width: 375px) and (max-width: 413px) {
    :root {
        --font-scale: var(--font-scale-sm);
    }
}

@media (min-width: 414px) and (max-width: 479px) {
    :root {
        --font-scale: var(--font-scale-md);
    }
}

@media (min-width: 480px) and (max-width: 767px) {
    :root {
        --font-scale: var(--font-scale-lg);
    }
}

@media (min-width: 768px) {
    :root {
        --font-scale: var(--font-scale-tablet);
    }
}

/* =================================================================== */
/* ENHANCED SAFE AREA HANDLING */
/* =================================================================== */

.safe-area-container {
    padding-top: var(--safe-area-top-extended);
    padding-bottom: var(--safe-area-bottom-extended);
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
}

/* iOS Dynamic Island support */
@supports (top: env(safe-area-inset-top)) {
    .header {
        padding-top: max(var(--spacing-md), var(--safe-area-inset-top));
    }

    .input-area {
        padding-bottom: max(var(--spacing-lg), var(--safe-area-inset-bottom));
    }
}

/* iPhone notch handling */
@media screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) {
    .header {
        padding-top: max(20px, var(--safe-area-inset-top));
    }
}

/* iPhone Pro Max notch handling */
@media screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) {
    .header {
        padding-top: max(20px, var(--safe-area-inset-top));
    }
}

/* =================================================================== */
/* FOLDABLE DEVICE SPECIFIC STYLES */
/* =================================================================== */

.device-foldable .main-container {
    display: grid;
    grid-template-columns: 1fr var(--foldable-hinge-margin) 1fr;
    gap: 0;
}

.device-foldable .chat-area {
    grid-column: 1;
}

.device-foldable .sidebar {
    grid-column: 3;
    position: static;
    transform: none;
    width: auto;
}

.device-foldable .hinge-spacer {
    grid-column: 2;
    background: var(--bg-tertiary);
    border-left: 1px solid var(--border-primary);
    border-right: 1px solid var(--border-primary);
}

/* Foldable landscape mode */
.device-foldable.orientation-landscape .main-container {
    grid-template-columns: 1fr;
    grid-template-rows: 1fr auto;
}

.device-foldable.orientation-landscape .chat-area {
    grid-row: 1;
}

.device-foldable.orientation-landscape .sidebar {
    grid-row: 2;
    width: 100%;
    height: 200px;
    overflow-y: auto;
}

/* =================================================================== */
/* IMPROVED ACCESSIBILITY */
/* =================================================================== */

/* High contrast mode enhancements */
@media (prefers-contrast: high) {
    .touch-target {
        border: 2px solid var(--text-primary);
    }

    .message {
        border: 1px solid var(--border-primary);
    }

    .status-item {
        background: var(--bg-secondary);
        border: 2px solid var(--border-accent);
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .sidebar {
        transition: none;
    }

    .message {
        animation: none;
    }

    * {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
    }
}

/* Large text support */
@media (prefers-reduced-data: reduce) {
    .avatar,
    .background-animations {
        display: none;
    }
}

/* =================================================================== */
/* ADVANCED MEDIA QUERIES */
/* =================================================================== */

/* iPhone SE (320px) specific optimizations */
@media screen and (max-width: 320px) {
    .header {
        padding: 8px 12px;
    }

    .logo {
        font-size: 16px;
    }

    .status-bar {
        gap: 4px;
    }

    .status-item {
        font-size: 10px;
        padding: 2px 6px;
    }

    .message {
        font-size: 13px;
        padding: 10px 12px;
    }

    .input-field {
        font-size: 13px;
        padding: 10px 45px 10px 12px;
    }
}

/* Galaxy Fold unfolded (512px) specific */
@media screen and (min-width: 512px) and (max-width: 673px) {
    .main-container {
        grid-template-columns: 1fr 20px 1fr;
    }

    .chat-area {
        grid-column: 1;
    }

    .sidebar {
        grid-column: 3;
        position: static;
        transform: none;
        width: auto;
    }
}

/* iPad mini specific optimizations */
@media screen and (min-width: 768px) and (max-width: 820px) {
    .sidebar {
        width: 300px;
    }

    .message {
        max-width: 70%;
    }

    .input-container {
        max-width: 700px;
    }
}

/* iPad Pro 11" specific */
@media screen and (min-width: 834px) and (max-width: 1024px) {
    .sidebar {
        width: 340px;
    }

    .message {
        max-width: 65%;
    }
}

/* iPad Pro 12.9" specific */
@media screen and (min-width: 1024px) and (max-width: 1366px) {
    .sidebar {
        width: 380px;
    }

    .message {
        max-width: 60%;
    }

    .input-container {
        max-width: 1000px;
    }
}

/* Ultra-wide screens */
@media screen and (min-width: 1400px) {
    .main-container {
        max-width: 1400px;
        margin: 0 auto;
    }
}

/* =================================================================== */
/* PERFORMANCE OPTIMIZATIONS */
/* =================================================================== */

/* GPU acceleration for smooth animations */
.header,
.sidebar,
.message,
.input-area {
    transform: translateZ(0);
    will-change: transform;
}

/* Optimize repaints */
.touch-target:active {
    transform: scale(0.95) translateZ(0);
}

/* Reduce layout thrashing */
.responsive-grid {
    contain: layout;
}

.message {
    contain: content;
}

/* =================================================================== */
/* UTILITY CLASSES */
/* =================================================================== */

.hide-on-small {
    display: block;
}

@media (max-width: 374px) {
    .hide-on-small {
        display: none;
    }
}

.show-on-small {
    display: none;
}

@media (max-width: 374px) {
    .show-on-small {
        display: block;
    }
}

.phone-only {
    display: block;
}

@media (min-width: 768px) {
    .phone-only {
        display: none;
    }
}

.tablet-only {
    display: none;
}

@media (min-width: 768px) {
    .tablet-only {
        display: block;
    }
}

.landscape-only {
    display: none;
}

.orientation-landscape .landscape-only {
    display: block;
}

.portrait-only {
    display: block;
}

.orientation-landscape .portrait-only {
    display: none;
}

/* =================================================================== */
/* DEBUG AND DEVELOPMENT HELPERS */
/* =================================================================== */

.responsive-debug {
    position: fixed;
    top: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px;
    font-size: 12px;
    z-index: 9999;
    font-family: monospace;
}

.responsive-debug::after {
    content: 'W: ' attr(data-width) ' H: ' attr(data-height) ' D: ' attr(data-device);
}

/* Only show in development */
body:not(.production) .responsive-debug {
    display: block;
}