{
  "name": "Production Deploy Workflow",
  "description": "Workflow completo de deployment a producci√≥n",
  "version": "1.0.0",
  "steps": [
    {
      "id": "pre-deploy",
      "name": "Pre-Deployment Checks",
      "type": "parallel",
      "actions": [
        {
          "name": "Run Tests",
          "command": "npm test",
          "timeout": 300000,
          "onFailure": "stop"
        },
        {
          "name": "Lint Code",
          "command": "npm run lint",
          "timeout": 60000,
          "onFailure": "warn"
        },
        {
          "name": "Security Audit",
          "command": "npm audit",
          "timeout": 120000,
          "onFailure": "warn"
        }
      ]
    },
    {
      "id": "build",
      "name": "Build Application",
      "type": "sequential",
      "actions": [
        {
          "name": "Clean Build",
          "command": "npm run clean",
          "timeout": 30000
        },
        {
          "name": "Build Production",
          "command": "npm run build:prod",
          "timeout": 600000,
          "onFailure": "stop"
        }
      ]
    },
    {
      "id": "verify",
      "name": "Verify Environment",
      "type": "sequential",
      "actions": [
        {
          "name": "Check Env Variables",
          "command": "node scripts/verify-env.js production",
          "timeout": 30000,
          "onFailure": "stop"
        },
        {
          "name": "Verify Build Output",
          "command": "node scripts/verify-build.js",
          "timeout": 30000,
          "onFailure": "stop"
        }
      ]
    },
    {
      "id": "deploy",
      "name": "Deploy to Production",
      "type": "sequential",
      "actions": [
        {
          "name": "Backup Current",
          "command": "npm run backup:current",
          "timeout": 60000
        },
        {
          "name": "Deploy",
          "command": "npm run deploy:prod",
          "timeout": 900000,
          "onFailure": "rollback"
        }
      ]
    },
    {
      "id": "post-deploy",
      "name": "Post-Deployment Verification",
      "type": "sequential",
      "actions": [
        {
          "name": "Health Check",
          "command": "curl -f https://api.production.com/health",
          "timeout": 60000,
          "retries": 3,
          "onFailure": "alert"
        },
        {
          "name": "Smoke Tests",
          "command": "npm run test:smoke:prod",
          "timeout": 180000,
          "onFailure": "alert"
        }
      ]
    }
  ],
  "notifications": {
    "onSuccess": ["slack", "email"],
    "onFailure": ["slack", "email", "pagerduty"]
  }
}

